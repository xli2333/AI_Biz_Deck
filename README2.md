# BizDeck - 全流程智能商用演示文稿生成系统

> **智用AI，讲述商业故事。**  
> BizDeck 不仅仅是一个 PPT 工具，而是一个拥有“咨询顾问大脑”与“专业设计师双手”的智能 Agent。它致力于将繁琐的文档排版工作转化为自动化的数据流处理，让创作者专注于核心逻辑与故事叙述。

## 1. 产品目的 (Product Purpose)

在传统的商业与学术演示文稿制作中，创作者往往花费 80% 的时间在排版、配色与素材寻找上，仅有 20% 的时间用于深度思考。BizDeck 旨在通过 AI 重构这一流程：

*   **解放生产力**：从非结构化的文档（PDF/Word/文本）直接生成结构化的演示文稿，实现从“原材料”到“成品”的端到端自动化。
*   **逻辑与视觉解耦**：确立“先逻辑，后视觉”的生成范式。系统优先构建严谨的 SCQA（情境-冲突-问题-答案）叙事结构，确认逻辑无误后再进行高保真视觉渲染。
*   **风格克隆与定制**：打破模板限制，通过反向工程技术，让 AI 学习并模仿特定机构（如顶级咨询公司或知名学府）的视觉语言。
*   **跨语言交付**：支持中英双语内容的理解与生成，确保语义对齐与专业表达。

## 2. 产品设计 (Product Design)

本系统采用 **Agentic Workflow（智能体工作流）** 架构，由多个专用子智能体协同工作：

### 2.1 核心架构
*   **逻辑引擎 (The Logic Brain)**: 负责理解用户意图、分析输入材料、提取关键信息，并构建演示大纲。它扮演“项目经理”角色，决定每一页讲什么、用什么图表。
*   **视觉引擎 (The Visual Engine)**: 负责将逻辑描述转化为具体的视觉画面。它扮演“美术指导”角色，严格遵循配色规范、栅格系统与图表设计原则，直接渲染出高分辨率的幻灯片图像。
*   **交互闭环 (Interactive Loop)**: 允许用户在“大纲阶段”和“单页阶段”介入。用户的一句话修改指令（如“把这页的语气改得更激进一点”或“把背景换成深蓝色”）会被翻译成系统 Prompt，实时更新结果。

### 2.2 视觉生成原理
不同于传统的基于 DOM 元素的 PPT 生成器，BizDeck 采用 **Pixel-Perfect Rendering（像素级渲染）** 技术：
1.  **Prompt 编译**: 将幻灯片的数据点、布局要求、配色代码编译成一段长达 1000+ token 的绘图指令。
2.  **直接成像**: 视觉模型直接输出 16:9 的高清图像，确保了复杂的图表（如瀑布图、矩阵图）和排版（如杂志风、留白）不再受限于 HTML/CSS 的布局能力。
3.  **后期处理**: 内置 4K 超分模块与局部重绘模块，支持对生成结果进行无损放大与细节微调。

## 3. 产品功能 (Product Features)

### 3.1 智能资料摄入 (Smart Ingestion)
*   支持上传 PDF 研报、文档或直接输入文本描述。
*   内置文件解析器，能处理图文混排的源文件，提取核心观点作为生成素材。

### 3.2 自定义风格框架 (Custom Style Framework)
*   **风格反向工程**: 用户上传一份 PDF（如某公司的内部分享材料），系统自动分析并提取其“视觉 DNA”（配色 Hex、字体特征、版式结构）与“逻辑 DNA”（行文语气、论证方式）。
*   **咨询顾问预设**: 内置主流管理咨询公司（如 McKinsey, BCG, Bain 风格）的思维模型与视觉规范。

### 3.3 动态大纲构建 (Dynamic Outlining)
*   自动生成 SCQA 结构的故事线。
*   支持拖拽、增删、修改大纲节点，AI 会根据修改后的上下文自动调整后续页面的内容。

### 3.4 像素级幻灯片生成 (High-Fidelity Generation)
*   **图表自适应**: 根据数据类型自动选择最佳图表（柱状图、折线图、散点图、概念图等）。
*   **智能配图**: 自动理解内容并生成高质量的背景图或插图，而非简单的素材库拼接。

### 3.5 深度编辑与优化 (Refinement & Upscale)
*   **自然语言修图**: 用户可以通过对话修改画面（例如：“把红色的柱子改成蓝色”，“去掉左上角的 Logo”），无需掌握 PS 技能。
*   **4K 超清输出**: 集成超分辨率算法，将生成的 1K 预览图一键升级为 4K 广播级图像，清晰度满足大型投影需求。

## 4. 技术栈 (Tech Stack)

### 前端架构 (Frontend)
*   **Core Framework**: `React 19` - 利用最新的并发特性处理复杂的 AI 流式响应。
*   **Language**: `TypeScript` - 强类型保障业务逻辑的严密性，特别是复杂的 Slide/Outline 数据结构。
*   **Build Tool**: `Vite` - 极速的开发与构建体验。
*   **Styling**: `Tailwind CSS` - 原子化 CSS 实现高效、现代的 UI 开发。
*   **PDF Processing**: `pdfjs-dist` (解析) & `jspdf` (生成) - 实现浏览器端的 PDF 读写能力。
*   **Icons**: `lucide-react` - 现代化、一致的图标库。

### AI 核心 (AI Core)
*   **Multimodal LLM (多模态大模型)**: 
    *   **Logic Model**: 处理长文本分析、逻辑推理、JSON 结构化输出。
    *   **Visual Model**: 理解复杂的视觉指令，生成包含精准文字与图表的幻灯片图像。
    *   系统通过精心设计的 `Prompt Engineering` (提示词工程) 来调度这些模型，实现了从模糊需求到精确输出的转化。

## 5. 目录结构说明 (Directory Structure)

```text
C:\Users\LXG\BizDeck\
├── App.tsx                 # 应用主入口，包含状态管理与核心业务流控制
├── components\
│   └── SlideView.tsx       # 幻灯片展示组件，处理缩放、交互与编辑模式
├── services\
│   ├── geminiService.ts    # AI 服务层：封装了与大模型的所有交互（文本/图像/多模态）
│   └── pdfService.ts       # PDF 服务层：处理文档上传解析与最终成品的导出
├── constants.ts            # 系统常量：存储预设的 Prompt 模板（McKinsey/BCG 等风格定义）
├── types.ts                # 类型定义：Slide, OutlineItem, GenerationState 等核心数据结构
├── CUSTOM_FRAMEWORK_FLOW.md # 自定义风格功能的详细技术文档
└── ... (配置文件)
```

## 6. 快速开始 (Getting Started)

### 环境要求
*   Node.js 18+

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

### 部署构建
```bash
npm run build
```

---
*BizDeck V2 - Powered by Advanced AI Strategy Engine*